<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Automation with Branches and Loops  " />
  <meta name="copyright" content="<span class='footer-right'><a href='../acknowledgements.html'>Acknowledgements</a></span><span class='footer-right'><a href=' https://etherpad.wikimedia.org/p/rspatial-bgs24 ' target='_blank'>Forum</a></span><span class='footer-right'><a href=' https://ajlyons.github.io/rspatial_bgs24 '> https://ajlyons.github.io/rspatial_bgs24 </a></span><span class='footer-right'><a href='../index.html'>Home</a></span><span class='footer-subtitle'> R for GIS </span>"/>
  <meta name="font-size-adjustment" content="2"/>
  <title>R for GIS  BayGeo, Spring 2024</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            .sourceCode { overflow: visible; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { color: #008000; } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { color: #008000; font-weight: bold; } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
          </style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACkUlEQVQ4jX2SW0jTcRTHTzNyeZlh6lqmm3POdNPC6SxSEzaqafkykOFoIxTDWpKRFV6iQMNLFyMSsQvUW0WORc2WWBmGKEGZXUyz0NrmNmfa1PYgfHsQ1v5oHjgvX875/M45vy/R8mDJ9caxrFIL5CUWJB00Q9n+7Q+l1BetUMuMTL3JpTB0QVnejd1Hu9DQ60G5eQbqB7PIvj0L2bUZ0KZzghWbs0o7Fx3Tc/B6vStm6+g0wrQvIKh2gKKyUxnNSZoO685SC1YDeL1e9Ll+Ia7WCd5pJ4hojQ8g1nViezETYBqZx93BOdwa9jAgsdUT4J6ZQqC6f4GIiLYU9/RzNWYIdU9hd/8rLjN7UGT8DbWROVVMlQsBBWas142DiIikdfbFMF0POIVm2NzM1zwLS+mvcSsnEajpBSv/8RIgucGJ1EYXEs+NwjrlWfUGMee/Y2PFJIJLrFibex8kOsahhCYnUlpnIL1kh9X9/yMKG2yIOOlAsPYnAveZsE75EEQUQLwTwy5Rsxvx9UxApKEPEYY+BiSizA623oaggkdgq4xLKwRLq7i8sy6EFlpg8wNEVwyAd3wAbZ8cPu3CazeCC/sRojYjaL8Jvm8MPWLDBm03A8CveQ9+7RBia4cYU4QfeokwzTOwc6/4OzKXHap/C5ufD0RNo0i4OAZR81dcnnD69Mp3PxBe9GRkuZdFKk7sqTcQ132EpGUMydetSLnpgOSGHVtbxpHU9AX8mkFEG55/ZrjQL1h82V6esPLVh8Sr40i940J6xzzS7s1C0m6HqHEEiTnatgT5gcPijHxltFwhjpRIQpZjBAJ2lFTBFW5TiOPT8mXx6apdcRl5OaJM1Q6hLC9ls3RPTLgok0NELCKiv02kPqt/O1MZAAAAAElFTkSuQmCC" rel="icon" type="image/x-icon" />
  <meta name="robots" content="noindex,nofollow"/>
  <script language="javascript" type="text/javascript">
  function TriShowHide(shID) {
    shIDspan = shID + "span";
    shIDdiv = shID + "div";
    if (document.getElementById(shIDdiv).style.display != 'block') {
      document.getElementById(shIDdiv).style.display = 'block';
      txtSpan = "&#9660;";
    } else {
      document.getElementById(shIDdiv).style.display = 'none';
      txtSpan = "&#9654;";
    }
    document.getElementById(shIDspan).innerHTML = txtSpan + " ";
  }
  function showHide(shID) {
    if (shID=="soln-show-all") {
      var allAnswerCode = document.getElementsByClassName("answer-code");
      for (i = 0; i < allAnswerCode.length; i++) {
          allAnswerCode[i].style.display = 'block';
      }
    } else if (shID=="soln-hide-all") {
      var allAnswerCode = document.getElementsByClassName("answer-code");
      for (i = 0; i < allAnswerCode.length; i++) {
          allAnswerCode[i].style.display = 'none';
      }
    } else if (shID=="hints-show-all") {
      var allAnswerCode = document.getElementsByClassName("hint");
      for (i = 0; i < allAnswerCode.length; i++) {
          allAnswerCode[i].style.display = 'block';
      }
    } else if (shID=="hints-hide-all") {
      var allAnswerCode = document.getElementsByClassName("hint");
      for (i = 0; i < allAnswerCode.length; i++) {
          allAnswerCode[i].style.display = 'none';
      }
    } else {
      if (document.getElementById(shID)) {
        if (document.getElementById(shID).style.display != 'block') {
          document.getElementById(shID).style.display = 'block';
        } else {
          document.getElementById(shID).style.display = 'none';
        }
      }
    }
  }
  function CopyToClipboard(containerid) {
  if (document.selection) {
      var range = document.body.createTextRange();
      range.moveToElementText(document.getElementById(containerid));
      range.select().createTextRange();
      document.execCommand("copy");
  } else if (window.getSelection) {
      var range = document.createRange();
      range.selectNode(document.getElementById(containerid));
      window.getSelection().addRange(range);
      document.execCommand("copy");
      // alert("text copied")
  }}
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163964617-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-163964617-1');
  </script>
  <script src="lib/header-attrs-2.25/header-attrs.js"></script>
  <link href="lib/slidy-2/styles/slidy.css" rel="stylesheet" />
  <script src="lib/slidy-2/scripts/slidy.js"></script>
  <script src="lib/slidy_shiny-1/slidy_shiny.js"></script>
  <script src="lib/clipboard-1.7.1/clipboard.min.js"></script>
  <link href="lib/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
  <link href="lib/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
  <script src="lib/klippy-0.0.0.9500/js/klippy.min.js"></script>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
   href="../css/slidy_styles.css" />
  <meta name="duration" content="0" />
</head>
<body>
<script type="text/javascript">w3c_slidy.mouse_click_enabled = false;</script>
<div class="slide titlepage">
  <h1 class="title"><span class="course-title">R for GIS
</span><br/><span class="course-subtitle">BayGeo, Spring
2024</span></h1>
  <p class="author">
Automation with Branches and Loops
<br/><img src='images/code_flowchart_320x280x256.png'/>
  </p>
</div>
<div class="slide section level1">

<p><br />
</p>
<p><br />
</p>
<p><img src="./images/postit_bg-trans_with-note_320x320.png"
style="display:block; margin:1em auto; border:none;" /></p>
</div>
<div id="the-keys-to-automation-branches-and-loops"
class="slide section level1">
<h1>The Keys to Automation: Branches and Loops</h1>
<p><img src="images/linear-vs-loops-branches_744x422x256.png"
style="display:block; margin:1em auto;" /></p>
</div>
<div id="branching-with-if-and-else-statements"
class="slide section level1">
<h1>Branching with <code>if</code> and <code>else</code> Statements</h1>
<script>
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p><code>if</code> and <code>else</code> statements are control
structures that let you control how a code should execute based on a set
of pre-established conditions.</p>
<p>Syntax:</p>
<p><code>if (condition) {statement} else {other statement}</code></p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb1"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## Example if statement</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">7</span>) {</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">print</span>(x)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;NOT BIG ENOUGH!!&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;NOT BIG ENOUGH!!&quot;</code></pre>
</div>
<div class="infobox">
<ul>
<li>the conditional expression after the <code>if</code> statement much
be in (parentheses)<br />
</li>
<li>Use {curly braces} to define chunks of code<br />
</li>
<li>indentation is not mandatory, but makes the code more legible<br />
</li>
</ul>
</div>
<!--- infobox --->
<div class="tip">
<p><strong>Composite tests with ‘and’ and ‘or’</strong></p>
<p>You can test for multiple conditions using the
<code>&amp;&amp;</code> (and) and <code>||</code> (or) operators.</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>(x <span class="sc">&lt;</span> <span class="dv">5</span>) <span class="sc">&amp;&amp;</span> (y <span class="sc">&lt;</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>(x <span class="sc">&lt;</span> <span class="dv">5</span>) <span class="sc">&amp;&amp;</span> (y <span class="sc">&lt;</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>(x <span class="sc">&lt;</span> <span class="dv">5</span>) <span class="sc">||</span> (y <span class="sc">&lt;</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<!--- tip --->
<h2 id="if-else-if-else">if () {…} else if () {…} else {…}</h2>
<p>You can string together multiple ‘else if’ checks.</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb9"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="do">## Generate a sample number between 1 and 20</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>x</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">## See what its divisible by</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="cf">if</span> (x <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;You picked an even number&quot;</span>)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (x <span class="sc">%%</span> <span class="dv">3</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;You picked a multiple of 3&quot;</span>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (x <span class="sc">%%</span> <span class="dv">5</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;You picked a multiple of 5&quot;</span>)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;You picked a prime&quot;</span>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 9
## [1] &quot;You picked a multiple of 3&quot;</code></pre>
</div>
<div class="infobox">
<p>The <strong><code>ifelse()</code></strong> function</p>
<p>A variation of the <code>if-else</code> statement is the
<strong><code>ifelse()</code></strong> function. This function is handy
for recoding data.</p>
<p>Syntax:</p>
<p><span style="font-family:monospace;">ifelse(<em>condition</em>,
<em>value-if-true</em>, <em>value-if-false</em>)</span></p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>is_cat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(animal<span class="sc">==</span><span class="st">&quot;cat&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)       </span></code></pre></div>
</div>
</div>
<!--- infobox --->
</div>
<div id="code-loops" class="slide section level1">
<h1>Code Loops</h1>
<ul>
<li>loops are fundamental to automation</li>
<li>use a <strong>for</strong> loop if you know in advance how many
passes<br />
</li>
<li>use a <strong>while</strong> loop if you have to do a check to see
if you need to continue going through the loop</li>
</ul>
<p><img src="images/code-loops_506x400x256.png" /></p>
<h2 id="for-loops">For loops</h2>
<p>Generic syntax of a for loop:</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb12"><pre
class="sourceCode r sample_code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="cf">for</span> (xx <span class="cf">in</span> yy) {</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="do">## </span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="do">## lines of code go here</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a> </span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>You generally loop a variable like <em>i</em> over a vector of values
to control the loop:</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb13"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">## Simple &#39;for&#39; loop</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">print</span>(i <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 4
## [1] 9
## [1] 16
## [1] 25</code></pre>
</div>
<p>Often the loop variable is used as an index:</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb15"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="do">## Using a loop variable as an index to grab elements</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">print</span>(state.name[i])</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Alabama&quot;
## [1] &quot;Alaska&quot;
## [1] &quot;Arizona&quot;
## [1] &quot;Arkansas&quot;
## [1] &quot;California&quot;</code></pre>
</div>
<p>Loops can be combined with if-else statements:</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb17"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="do">## Loop with an if-then statement in the middle</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>    <span class="cf">if</span>(x[i] <span class="sc">&gt;=</span> <span class="dv">7</span>) { </span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>        <span class="fu">print</span>(x[i])</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>    } <span class="cf">else</span> {                     </span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;NOT BIG ENOUGH!!&quot;</span>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    }</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;NOT BIG ENOUGH!!&quot;
## [1] &quot;NOT BIG ENOUGH!!&quot;
## [1] &quot;NOT BIG ENOUGH!!&quot;
## [1] &quot;NOT BIG ENOUGH!!&quot;
## [1] &quot;NOT BIG ENOUGH!!&quot;
## [1] &quot;NOT BIG ENOUGH!!&quot;
## [1] 7
## [1] 8
## [1] 9
## [1] 10</code></pre>
</div>
<h2 id="while-loops">While Loops</h2>
<p>The generic form of a while loop is:</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb19"><pre
class="sourceCode r sample_code"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="cf">while</span> (some_condition) {</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="do">## </span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="do">## lines of code go here</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  </span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>It’s <em>really</em> important that <em>some_condition</em> will
eventually be FALSE, otherwise the loop will run forever!</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb20"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="do">## Define i</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="do">## Go through the loop as long as i is &lt; 0.95</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">&lt;</span> <span class="fl">0.95</span>) {</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="do">## Generate i again as a random number between 0..1</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(i,<span class="dv">2</span>))</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.4
## [1] 0.67
## [1] 0.27
## [1] 0.85
## [1] 0.02
## [1] 0.35
## [1] 0.28
## [1] 0.18
## [1] 0.14
## [1] 0.55
## [1] 0.8
## [1] 0.4
## [1] 0.7
## [1] 0.02
## [1] 0.04
## [1] 0.94
## [1] 0.55
## [1] 0.5
## [1] 0.32
## [1] 0.29
## [1] 0.66
## [1] 0.99</code></pre>
</div>
<div class="tip">
<p><strong>break</strong></p>
<p>Another way to escape out of a loop is the <code>break</code>
statement:</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb22"><pre
class="sourceCode r sample_code"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="cf">if</span> (something_important_happens) {</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  }</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<!--- tip --->
</div>
<div id="looping-through-data-frames" class="slide section level1">
<h1>Looping Through Data Frames</h1>
<p>One of the most common uses of a loop is to loop through a data
frame.</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb23"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="do">## Loop thru a data frame</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Orange)) {</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  circum_by_age <span class="ot">&lt;-</span> Orange[i, <span class="st">&quot;circumference&quot;</span>]  <span class="sc">/</span>  Orange[i, <span class="st">&quot;age&quot;</span>] </span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="cf">if</span> (circum_by_age <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;High ratio found in row &quot;</span>, i, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  }</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## High ratio found in row  1 
## High ratio found in row  8 
## High ratio found in row  15 
## High ratio found in row  22 
## High ratio found in row  29</code></pre>
</div>
<div class="tryit">
<p>Loop through the data frame <em>mtcars</em>, and print out the value
of the <em>wt</em> column.</p>
<p>[<span id="qtn_baxhcnz" class="showhidesoln"
onclick="showHide(&#39;baxhcnz&#39;);return false;">Solution</span>]</p>
<div id="baxhcnz" class="hint">
<div class="sourceCode" id="cb25"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars)) {</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="fu">print</span>(mtcars[i, <span class="st">&quot;wt&quot;</span>])</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 2.62
## [1] 2.875
## [1] 2.32
## [1] 3.215
## [1] 3.44
## [1] 3.46
## [1] 3.57
## [1] 3.19
## [1] 3.15
## [1] 3.44
## [1] 3.44
## [1] 4.07
## [1] 3.73
## [1] 3.78
## [1] 5.25
## [1] 5.424
## [1] 5.345
## [1] 2.2
## [1] 1.615
## [1] 1.835
## [1] 2.465
## [1] 3.52
## [1] 3.435
## [1] 3.84
## [1] 3.845
## [1] 1.935
## [1] 2.14
## [1] 1.513
## [1] 3.17
## [1] 2.77
## [1] 3.57
## [1] 2.78</code></pre>
</div>
</div>
</div>
<div id="recording-the-results-of-each-iteration"
class="slide section level1">
<h1>Recording the Results of Each Iteration</h1>
<p>Loops are commonly used to apply an algorithm to each element or
row.</p>
<p>You may want to store or save the results of each pass. A common
technique is to create a variable to save the results before you start
the loop, and then update or append it within the loop.</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb27"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="do">## Set up a variable to store the cummulative number of assaults</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>num_assaults <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="do">## Loop thru the USArrests data frame and increment the num_assaults variable</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(USArrests)) {</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  num_assaults <span class="ot">&lt;-</span> num_assaults <span class="sc">+</span> USArrests[i, <span class="st">&quot;Assault&quot;</span>]</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>}</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="do">## Print the final result</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="fu">print</span>(num_assaults)</span></code></pre></div>
<pre><code>## [1] 8538</code></pre>
</div>
</div>
<div id="looping-through-files" class="slide section level1">
<h1>Looping through Files</h1>
<p>Create a character vector of file names:</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb29"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>my_shapefiles <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">&quot;./data&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;.shp$&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="cf">for</span> (fn <span class="cf">in</span> my_shapefiles) {</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="fu">print</span>(fn)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  </span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  <span class="do">## Or do something with the file, such as:</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  <span class="do">## x &lt;- st_read(file.path(&quot;./data&quot;, fn)) </span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  <span class="do">## st_write(x |&gt; st_transform(4326), file.path(&quot;./unprojected/&quot;, fn))</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>  </span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;sf_schools.shp&quot;
## [1] &quot;veg37.shp&quot;
## [1] &quot;yose_boundary.shp&quot;
## [1] &quot;yose_poi.shp&quot;</code></pre>
</div>
<div class="tip">
<p>The <code>pattern</code> argument in <code>list.files()</code> takes
a <em>regular expression</em>.<br />
To match files by the end of their name (i.e., extension), add the
<code>$</code> character at the end (e.g., “.shp$”).<br />
To match files by the beginning of their name, add the <code>^</code>
character at the beginning (e.g., “^sf”)</p>
<p><strong><code>list.files()</code></strong> has several optional
arguments you can use to specify the files returned:</p>
<div class="indented2">
<ul>
<li><code>recursive</code><br />
</li>
<li><code>include.dirs</code></li>
<li><code>ignore.case</code><br />
</li>
<li><code>full.names</code><br />
</li>
</ul>
</div>
<p>Another approach is to create a text file with the file names, and
loop through those (see next).</p>
</div>
<!--- tip --->
</div>
<div id="looping-through-the-lines-of-a-text-file"
class="slide section level1">
<h1>Looping through the Lines of a Text File</h1>
<p>Another common automation technique is to loop through the lines of a
text file, which may contain file names, sets of parameters, etc.</p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb31"><pre
class="sourceCode r klippy copyme"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="do">## Define a filename to a text file</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>txt_fn <span class="ot">&lt;-</span> <span class="st">&quot;./data/proverbs.txt&quot;</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="do">## Open a &#39;read-only&#39; connection to the text file</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>con <span class="ot">=</span> <span class="fu">file</span>(txt_fn, <span class="st">&quot;r&quot;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="do">## Loop through the lines of the file </span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  <span class="do">## Read the next line with readLines (returns a character object)</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  my_line <span class="ot">&lt;-</span> <span class="fu">readLines</span>(con, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  </span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  <span class="do">## Check to see if we&#39;re at the end</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(my_line) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>    <span class="do">## Gotten to the end. Time to exit the loop.</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  }</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>  </span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>  <span class="do">## Do something</span></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>  <span class="fu">print</span>(my_line)</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>}</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a><span class="do">## Close the connection to the text file</span></span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a><span class="fu">close</span>(con)</span></code></pre></div>
<pre><code>## [1] &quot;If a donkey kicks you and you kick back, you are both donkeys. (Gambia)&quot;
## [1] &quot;An adult squatting sees farther than a child on top of tree. (Gambia)&quot;
## [1] &quot;A fly that has no one to advice it, follows the corpse into the grave. (Gambia)&quot;
## [1] &quot;Giant silk cotton trees grow out of very tiny seeds. (Gambia)&quot;
## [1] &quot;However black a cow is, the milk is always white. (Gambia)&quot;
## [1] &quot;The disobedient fowl obeys in a pot of soup (Benin - Nigeria).&quot;
## [1] &quot;When two elephants fight it is the grass that suffers (Uganda).&quot;
## [1] &quot;The frog does not jump in the daytime without reason (Nigeria).&quot;
## [1] &quot;One goat cannot carry another goat&#39;s tail (Nigeria).&quot;
## [1] &quot;The family is like the forest, if you are outside it is dense, if you are inside you see that each tree has its own position (Akan).&quot;
## [1] &quot;It is the woman whose child has been eaten by a witch who best knows the evils of witchcraft (Nigeria).&quot;
## [1] &quot;The hunter does not rub himself in oil and lie by the fire to sleep (Nigeria).&quot;
## [1] &quot;The hunter in pursuit of an elephant does not stop to throw stones at birds (Uganda).&quot;
## [1] &quot;If all seeds that fall were to grow, then no one could follow the path under the trees (Akan).&quot;
## [1] &quot;Even the mightest eagle comes down to the tree tops to rest (Uganda).&quot;
## [1] &quot;A tiger does not have to proclaim its tigri-tude (Wole Soyinka - Nigeria).&quot;
## [1] &quot;Before you ask a man for clothes, look at the clothes that he is wearing (Yoruba, Nigeria).&quot;
## [1] &quot;Until lions have their own historians, tales of the hunt shall always glorify the hunter (Igbo, Nigeria).&quot;
## [1] &quot;Although the snake does not fly it has caught the bird whose home is in the sky (Akan)&quot;
## [1] &quot;One should never rub bottoms with a porcupine (Akan).&quot;
## [1] &quot;Fowls will not spare a cockroach that falls in their mist (Akan).&quot;
## [1] &quot;You do not need a big stick to break a cock&#39;s head (Akan).&quot;
## [1] &quot;Marriage is like a groundnut, you have to crack them to see what is inside (Akan).&quot;
## [1] &quot;The rain wets the leopard&#39;s spots but does not wash them off (Akan).&quot;</code></pre>
</div>
<div class="tip">
<p>CSV files are basically text files that have some structure (i.e.,
columns, column labels, text delimiters, etc.). They’re generally easier
to work with than plain text files, and easy to create. When possible,
use a CSV file over a text file.</p>
</div>
<!--- tip --->
</div>
<div id="better-alternatives-to-loops" class="slide section level1">
<h1>(Better) Alternatives to Loops</h1>
<p>Many R functions are vectorized, so often you don’t actually need a
code loop.</p>
<div class="indented2">
- see also <a
href="https://www.datacamp.com/community/tutorials/tutorial-on-loops-in-r"
target="_blank">Loops Tutorial from DataCamp</a>
</div>
<p><strong>Example: add a random offset to each element of
sequence</strong></p>
<div class="indented2 indented2r">
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="do">## Addition is vectorized, so we don&#39;t need a loop</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">num=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">num_plus_offset=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.5</span>))</span></code></pre></div>
<pre><code>##   num num_plus_offset
## 1   1       0.8947256
## 2   2       2.1730814
## 3   3       3.2898822
## 4   4       4.2666908
## 5   5       5.4088643</code></pre>
</div>
<p>In addition to for and while loops, R has functions like
<code>sapply()</code> and <code>lapply()</code> that will apply a
function to each element of a vector/list.</p>
<p><code>sapply()</code> and <code>lapply()</code> are generally usually
faster than traditional loops.</p>
<p><br />
</p>
<p>
<br/>
<hr/>
<strong>Next: </strong> <a href="r-arcgis.html">Connecting R &amp;
ArcGIS</a>
</p>
</div>

  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>
</html>
